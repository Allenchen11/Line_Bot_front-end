<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>傳送Line訊息推播</title>

	<link rel="stylesheet" type="text/css" href="./css/common.css">

	<script src="./js/jquery-3.5.1.min.js"></script>
</head>
<body>
<div class="container-fluid">


<p>請將從Line Bot Designer拿到的JSON貼上:</p>
<textarea id="jsonData" rows="30" cols="60"></textarea>
<button onclick="pushLineMessage()">送出訊息</button>
<p class="hide successMessage">訊息送出成功!</p>
<p class="hide failMessage">訊息送出失敗!</p>


</div>
<script type="text/javascript">


function pushLineMessage() {
	var requestURL = "http://localhost:8080/pushMessageToAllByJson";
	var dataJSON = $("#jsonData").val().trim();

	var jsonBasic = '{"to":"%%to%%","messages":[ %%messages%%]}';
	dataJSON = jsonBasic.replace('%%messages%%' , dataJSON);

$.ajax({
    url: requestURL,
    data: dataJSON,
    type: "POST",
    dataType: 'text',
    contentType: "application/json;charset=utf-8",
    success: function(returnData){
        console.log(returnData);
        if (returnData =='success') {
        	$('.successMessage').show();

        }
    },
    error: function(xhr, ajaxOptions, thrownError){
        console.log(xhr.status);
        console.log(xhr.responseText);
        console.log(xhr);
    }
});	
}


</script>
</body>



</html>